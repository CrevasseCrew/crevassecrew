{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"2025/04/29/palo-alto-panos-api-authentication/","title":"Palo Alto PANOS API Authentication","text":"<p>In this article we will explore the various methods used for authenticating against Palo Alto's PANOS API which allows administrators to programmatically interface with Palo Alto firewalls and Panorama appliances. The methods discussed cover both the XML and REST API's. There are a few considerations to make when deciding how to configure your appliances to authenticate API requests as well as how to handle API authentication in code.</p>","tags":["Palo Alto","Automation"]},{"location":"2025/04/29/palo-alto-panos-api-authentication/#api-authentication-configuration","title":"API Authentication Configuration","text":"","tags":["Palo Alto","Automation"]},{"location":"2025/04/29/palo-alto-panos-api-authentication/#minimum-required-configuration","title":"Minimum Required Configuration","text":"<p>The PANOS API requires, at a minimum, that a local administrator account exists with any of the Dynamic administrator types (e.g. superuser, device administrator, etc.). Other than in a lab environment it would not be recommended to use a local account that multiple administrators have access to, for authenticating requests of any form to your appliance. Accounts should always be attributable to a single user or function and given only the access that is necessary for that user/function. This is described in the subsequent section.</p>","tags":["Palo Alto","Automation"]},{"location":"2025/04/29/palo-alto-panos-api-authentication/#least-privileged-access-with-admin-roles","title":"Least Privileged Access with Admin Roles","text":"<p>Authenticating administrators to the API should be performed on a user/function basis. If you allow your administrators to use the API, you can configure the firewall admin roles to permit each role the specific level of access that is required. In situations where the API is used programmatically by an external service (e.g. a monitoring platform or some other automated system), it is beneficial to create admin roles for each external service. Each service often requires different levels of access and creating an admin role per service allows the necessary flexibility.</p> <p>For administrator based admin roles (e.g. the roles that authenticate a human logging into the appliance), you can set specific options on the XML API and REST API tabs of the admin role. Unfortunately, the documentation is a bit light on explaining each option for the XML API privileges and you only have the option to enable or disable access. There is greater flexibility for the REST API, similar to how you authorize an administrator to the web UI.</p> <p>For external service based admin roles (e.g. monitoring platforms), a good recommendation to follow is to disable all options across the various tabs of the admin role and then explicitly enable the options required for the external service. The account that an external service uses to programmatically access an appliance should never need to use the web UI. Although outside of the scope of this article, some external services still rely on CLI access and parsing CLI output instead of using API access. Consult the documentation associated with the external service or discuss with those who manage the code that interfaces with your appliances API.</p>","tags":["Palo Alto","Automation"]},{"location":"2025/04/29/palo-alto-panos-api-authentication/#authentication-profiles","title":"Authentication Profiles","text":"<p>Your devices authentication settings (Device &gt; Setup &gt; Management &gt; Authentication Settings) allows you to configure an authentication profile for non-local admins. If using SAML to authenticate administrators, starting in PANOS 10.2 you now how have the option to identify an authentication profile/sequence for non-UI access. It is required to configure non-SAML based authentication for accessing the API (and CLI), as redirecting to your IdP login page is not possible for these types of requests.</p> <p>If you're remotely authenticating logins with a method other than SAML, you only need to set the Authentication Profile at the above mentioned path (not the Authentication Profile Non-UI option).</p>","tags":["Palo Alto","Automation"]},{"location":"2025/04/29/palo-alto-panos-api-authentication/#api-key-lifetime","title":"API Key Lifetime","text":"<p>A common recommendation is that API keys should be rotated every 30 to 90 days. Palo Alto sets a dangerous default of zero which effectively indicates keys never expire. To adjust API key lifetime browse to Device &gt; Setup &gt; Management &gt; Authentication Settings and set the value for API Key Lifetime (values can be between 0 minutes, no expiration, and 525600 minutes which is 365 days).</p> <p>You should reference your organization best practices when determining to API key lifetime. In some cases the guideline may fall under a more general guideline around user/system authentication.</p> <p>In my opinion, there is no reason that the value shouldn't be similar to that of the standard Idle Timeout for administrator logins, especially if you allow administrators to access the API. If you must be in compliance with NIST or CIS, administrator login idle timeout values usually need to be 20 minutes or less. Although Palo Alto's Idle Timeout is detecting inactivity in an admin session, API key lifetime isn't measured between API calls, but from the point in time the key is generated regardless of how many API queries are made after that. What you may find is that some external platforms/products which use the API don't effectively check for API key duration and renew their API key when making a series of subsequent calls.</p>","tags":["Palo Alto","Automation"]},{"location":"2025/04/29/palo-alto-panos-api-authentication/#authentication-examples","title":"Authentication Examples","text":"","tags":["Palo Alto","Automation"]},{"location":"2025/04/29/palo-alto-panos-api-authentication/#obtaining-an-api-key","title":"Obtaining an API key","text":"<p>The preferred method for authenticating against the PANOS API is to generate an API key. This ensures that the username and password is only passed once to the device and subsequent API queries pass the timebound API key which will expire (as long as you have properly set an API key lifetime) . To generate an API key can use the /api/$type=keygen URL path on your Palo Alto appliance.</p> <p>Note</p> <p>If you're using special characters in the password, cURL may require that you use different options such as --data-urlencode for submitting form data. This will ensure that cURL interpret the special characters as part of the value associated with a form field and not part of the parametrization of the key/value pairs. In the below example the password has an &amp; character which would fail when using the -d cURL flag but is successfully passed when using --data-urlencode. Python's Request module already URL encodes the data values, so no additional changes are required.</p> <p>Warning</p> <p>Follow best practices when handling any form of credential/secret in code. The intent of this post is not meant to cover secure code practices, but to provide examples of working with the Palo Alto PANOS API.</p> PythoncURLcURL with special character password <p>The following shows using Python's Request package to send a POST request to the PANOS API to generate a new API key. <pre><code>import xml.etree.ElementTree as ET\nimport requests\n\nusername = 'apiuser'\npassword = 'JNn0Sg444s7D0jy5'\nBASE_URL = 'https://192.168.12.50/api/'\nparams = {\n    'type': 'keygen',\n}\nheaders = {\n    'Content-Type': 'application/x-www-form-urlencoded',\n}\ndata = {\n    'user': username,\n    'password': password,\n}\nresp = requests.post(\n    BASE_URL,\n    params=params,\n    headers=headers,\n    data=data,\n    verify=False,\n    timeout=5,\n)\nresp.raise_for_status()\n\nroot = ET.fromstring(resp.text)\nkey = root.find('result/key').text\n\nparams = {\n    'type': 'op',\n    'cmd': '&lt;show&gt;&lt;system&gt;&lt;info&gt;&lt;/info&gt;&lt;/system&gt;&lt;/show&gt;'\n}\nheaders = {\n    'X-PAN-KEY': key,\n}\nresp = requests.get(\n    BASE_URL,\n    params=params,\n    headers=headers,\n    verify=False,\n    timeout=5,\n)\nresp.raise_for_status()\n\nroot = ET.fromstring(resp.text)\noutput = root.find('result/system')\n</code></pre></p> <pre><code>curl -k -H \"Content-Type: application/x-www-form-urlencoded\" \\\n-X POST 'https://192.168.12.50/api/?type=keygen' \\\n-d 'user=apiuser&amp;password=JNn0Sg444s7D0jy5'\n</code></pre> <pre><code>curl -k -H \"Content-Type: application/x-www-form-urlencoded\" \\\n-X POST 'https://192.168.12.50/api/?type=keygen' \\\n-d 'user=apiuser' \\\n--data-urlencode 'password=JNn0Sg444s7D0jy5&amp;'\n</code></pre> <p>A successfully authenticated call to the API keygen path results in an XML response that includes the API key: XML response with API key<pre><code>&lt;response status = 'success'&gt;\n  &lt;result&gt;\n    &lt;key&gt;LUFRPT0xTFE0dHZzVEVMYUV4dlNuUi9GeFFjeVl4cE09R25NSVgyYysyVEw4VmZRakdTazc2cjFKK05HRGhoVXIvRGFYN1lFMHlRUXVwaXhNNjRsTitDNWNaL2pWWjNPbzk5NXhzRGtsQy92NnRudjRyeDh0K3c9PQ==&lt;/key&gt;\n  &lt;/result&gt;\n&lt;/response&gt;\n</code></pre></p>","tags":["Palo Alto","Automation"]},{"location":"2025/04/29/palo-alto-panos-api-authentication/#using-the-api-key-in-subsequent-api-calls","title":"Using the API key in subsequent API calls","text":"<p>Now that you have an API key you can use it in subsequent API calls. This example shows running an operational command on the device.</p> PythoncURL <pre><code>import xml.etree.ElementTree as ET\nimport requests\n\nusername = 'apiuser'\npassword = 'JNn0Sg444s7D0jy5'\nBASE_URL = 'https://192.168.12.50/api/'\nparams = {\n    'type': 'keygen',\n}\nheaders = {\n    'Content-Type': 'application/x-www-form-urlencoded',\n}\ndata = {\n    'user': username,\n    'password': password,\n}\nresp = requests.post(\n    BASE_URL,\n    params=params,\n    headers=headers,\n    data=data,\n    verify=False,\n    timeout=5,\n)\nresp.raise_for_status()\n\nroot = ET.fromstring(resp.text)\nkey = root.find('result/key').text\n\nparams = {\n    'type': 'op',\n    'cmd': '&lt;show&gt;&lt;system&gt;&lt;info&gt;&lt;/info&gt;&lt;/system&gt;&lt;/show&gt;'\n}\nheaders = {\n    'X-PAN-KEY': key,\n}\nresp = requests.get(\n    BASE_URL,\n    params=params,\n    headers=headers,\n    verify=False,\n    timeout=5,\n)\nresp.raise_for_status()\n\nroot = ET.fromstring(resp.text)\noutput = root.find('result/system')\n</code></pre> <pre><code>curl -k -H \"X-PAN-KEY: LUFRPT1Hd3dCOC80S3hqd1lMU01lbnBpOEN1MENkbEU9R25NSVgyYysyVEw4VmZRakdTazc2bnZNZnplcTdxVmpabGNTRnY3cENLNEEzaFpBbDM3N21xYlFYRjdJOFZOWDk1ajNTVTgrUGFlWU1PRmkvLzdtMFE9PQ==\" \\\n-G 'https://192.168.12.50/api/' \\\n-d type=op \\\n-d cmd='&lt;show&gt;&lt;system&gt;&lt;info&gt;&lt;/info&gt;&lt;/system&gt;&lt;/show&gt;'\n</code></pre> <p>The XML response to the API query for the operational command of 'show system info' would look like the following: <pre><code>&lt;response status=\"success\"&gt;\n  &lt;result&gt;\n    &lt;system&gt;\n      &lt;hostname&gt;PA-LAB&lt;/hostname&gt;\n      &lt;ip-address&gt;192.168.12.50&lt;/ip-address&gt;\n      &lt;public-ip-address&gt;unknown&lt;/public-ip-address&gt;\n      &lt;netmask&gt;255.255.255.0&lt;/netmask&gt;\n      &lt;default-gateway&gt;192.168.12.1&lt;/default-gateway&gt;\n      &lt;is-dhcp&gt;no&lt;/is-dhcp&gt;\n      &lt;ipv6-address&gt;unknown&lt;/ipv6-address&gt;\n      &lt;ipv6-link-local-address&gt;fe80::8e36:7aff:fe02:418e/64&lt;/ipv6-link-local-address&gt;\n      &lt;mac-address&gt;8c:36:7a:02:41:8e&lt;/mac-address&gt;\n      &lt;time&gt;Wed Apr 30 15:14:34 2025&lt;/time&gt;\n      &lt;uptime&gt;65 days, 8:44:39&lt;/uptime&gt;\n      &lt;devicename&gt;PA-LAB&lt;/devicename&gt;\n      &lt;family&gt;#########&lt;/family&gt;\n      &lt;model&gt;#########&lt;/model&gt;\n      &lt;serial&gt;#########&lt;/serial&gt;\n      &lt;cloud-mode&gt;non-cloud&lt;/cloud-mode&gt;\n      &lt;sw-version&gt;10.2.11-h12&lt;/sw-version&gt;\n      &lt;global-protect-client-package-version&gt;0.0.0&lt;/global-protect-client-package-version&gt;\n      &lt;device-dictionary-version&gt;172-597&lt;/device-dictionary-version&gt;\n      &lt;device-dictionary-release-date&gt;2025/04/25 12:16:03 MDT&lt;/device-dictionary-release-date&gt;\n      &lt;app-version&gt;8971-9419&lt;/app-version&gt;\n      &lt;app-release-date&gt;2025/04/28 16:06:06 MDT&lt;/app-release-date&gt;\n      &lt;av-version&gt;5169-5689&lt;/av-version&gt;\n      &lt;av-release-date&gt;2025/04/29 05:00:05 MDT&lt;/av-release-date&gt;\n      &lt;threat-version&gt;8971-9419&lt;/threat-version&gt;\n      &lt;threat-release-date&gt;2025/04/28 16:06:06 MDT&lt;/threat-release-date&gt;\n      &lt;wf-private-version&gt;0&lt;/wf-private-version&gt;\n      &lt;wf-private-release-date&gt;unknown&lt;/wf-private-release-date&gt;\n      &lt;url-db&gt;paloaltonetworks&lt;/url-db&gt;\n      &lt;wildfire-version&gt;955464-959418&lt;/wildfire-version&gt;\n      &lt;wildfire-release-date&gt;2025/02/24 07:42:12 MST&lt;/wildfire-release-date&gt;\n      &lt;wildfire-rt&gt;Disabled&lt;/wildfire-rt&gt;\n      &lt;url-filtering-version&gt;20250430.20332&lt;/url-filtering-version&gt;\n      &lt;global-protect-datafile-version&gt;unknown&lt;/global-protect-datafile-version&gt;\n      &lt;global-protect-datafile-release-date&gt;unknown&lt;/global-protect-datafile-release-date&gt;\n      &lt;global-protect-clientless-vpn-version&gt;0&lt;/global-protect-clientless-vpn-version&gt;\n      &lt;logdb-version&gt;10.2.1&lt;/logdb-version&gt;\n      &lt;plugin_versions&gt;\n        &lt;entry name='dlp' version='3.0.9'&gt;\n          &lt;pkginfo&gt;dlp-3.0.9&lt;/pkginfo&gt;\n        &lt;/entry&gt;\n      &lt;/plugin_versions&gt;\n      &lt;platform-family&gt;400&lt;/platform-family&gt;\n      &lt;vpn-disable-mode&gt;off&lt;/vpn-disable-mode&gt;\n      &lt;multi-vsys&gt;off&lt;/multi-vsys&gt;\n      &lt;ZTP&gt;Disabled&lt;/ZTP&gt;\n      &lt;operational-mode&gt;normal&lt;/operational-mode&gt;\n      &lt;advanced-routing&gt;off&lt;/advanced-routing&gt;\n      &lt;device-certificate-status&gt;Valid&lt;/device-certificate-status&gt;\n    &lt;/system&gt;\n  &lt;/result&gt;\n&lt;/response&gt;\n</code></pre></p>","tags":["Palo Alto","Automation"]},{"location":"2025/04/29/palo-alto-panos-api-authentication/#alternative-authentication-method","title":"Alternative Authentication Method","text":"<p>Warning</p> <p>I would discourage using the method mentioned in this section. The point of covering this is to highlight the method that Palo Alto encourages people to use, and to discuss the reasons for not using this method.</p> <p>Alternatively, Palo Alto encourages you to use HTTP basic auth to authenticate API requests. They make no mention of using the API key that was previously obtained. Generally speaking, basic auth should be discouraged as you are continually passing the username and password in every HTTP request in clear text. Basic auth only base 64 encodes the username and password and is easily reversable (decoded).</p> PythoncURL <pre><code>import xml.etree.ElementTree as ET\nimport requests\nfrom requests.auth import HTTPBasicAuth\n\nusername = 'apiuser'\npassword = 'JNn0Sg444s7D0jy5&amp;'\nBASE_URL = 'https://192.168.12.50/api/'\n\nparams = {\n    'type': 'op',\n    'cmd': '&lt;show&gt;&lt;system&gt;&lt;info&gt;&lt;/info&gt;&lt;/system&gt;&lt;/show&gt;'\n}\nresp = requests.get(\n    BASE_URL,\n    params=params,\n    verify=False,\n    timeout=5,\n    auth=HTTPBasicAuth(username, password)\n)\nresp.raise_for_status()\n\nroot = ET.fromstring(resp.text)\noutput = root.find('result/system')\n</code></pre> <pre><code>curl -k -G 'https://192.168.12.50/api/' \\\n-d type=op \\\n-d cmd='&lt;show&gt;&lt;system&gt;&lt;info&gt;&lt;/info&gt;&lt;/system&gt;&lt;/show&gt;' \\\n-u \"apiuser:JNn0Sg444s7D0jy5&amp;\"\n</code></pre> <p>As you can see in the above examples, the username and password are passed in each API query which makes it more susceptible to compromise. Instead, using the username and password to get an API key which is used in subsequent API queries ensures that the username/password are only used once.</p>","tags":["Palo Alto","Automation"]},{"location":"2025/04/29/palo-alto-panos-api-authentication/#additional-notes-on-api-authentication","title":"Additional Notes on API Authentication","text":"","tags":["Palo Alto","Automation"]},{"location":"2025/04/29/palo-alto-panos-api-authentication/#expiring-api-keys","title":"Expiring API Keys","text":"<p>Palo Alto provides a mechanism to expire all API keys. Unfortunately this can't be controlled on a key by key basis. Browse to Device &gt; Setup &gt; Management &gt; Authentication Settings and click the Expire All API Keys link.</p> <p>It's not obvious how changing the API key lifetime affects existing API keys. If you allow a long API key lifetime duration or used the default of zero (API keys never expire) and then adjust the lifetime to a lower duration, I would recommend expiring all keys after you have made the change.</p> <p>Also note that subsequent API key generation calls will immediately expire previous API keys associated with the account.</p>","tags":["Palo Alto","Automation"]},{"location":"2025/04/29/palo-alto-panos-api-authentication/#palo-alto-panos-api-key-weaknesses","title":"Palo Alto PANOS API Key Weaknesses","text":"<p>Warning</p> <p>The following details provide steps that show how the API key can be decoded and decrypted, resulting in the original username/password used to create the API key being returned. Do not submit production API keys to public sites. If you intend to test this out, only submit an API key used in a lab that you intend to rotate immediately after.</p> <p>If you're curious as to how the decryption is performed and how the following site is handling data you submit in the form, feel free to review the Github repo for panos-crypto-tools. Note that as of the writing of this post, decryption of the API key is done locally in your browser, no data is submitted to an external site. However, always validate beforehand.</p> <p>Although it is not documented on Palo Alto's site, it is well known that Palo Alto PANOS API keys contain the username/password that was used to create the API key in the first place. Although the API key is encrypted, its encrypted using the appliances master key. To make matters worse, very few organizations manage their master key effectively and often leave it set to the default value which is also well known. If a non-default master key is used but becomes compromised, your API keys can also be decrypted.</p> <p>To reverse a PANOS API key you first need to base64decode the key.</p> <pre><code>import base64\nkey = 'LUFRPT1Hd3dCOC80S3hqd1lMU01lbnBpOEN1MENkbEU9R25NSVgyYysyVEw4VmZRakdTazc2bnZNZnplcTdxVmpabGNTRnY3cENLNEEzaFpBbDM3N21xYlFYRjdJOFZOWDk1ajNTVTgrUGFlWU1PRmkvLzdtMFE9PQ=='\nbase64.b64decode(key)\n</code></pre> <p>The above Python code results in the following string being returned. <pre><code>b'-AQ==GwwB8/4KxjwYLSMenpi8Cu0CdlE=GnMIX2c+2TL8VfQjGSk76nvMfzeq7qVjZlcSFv7pCK4A3hZAl377mqbQXF7I8VNX95j3SU8+PaeYMOFi//7m0Q=='\n</code></pre></p> <p>If you take the string contained between the single quotes to the PANOS Crypto Tools site, you can decrypt the string further and see that it returns the username and password you have seen in previous examples within this post.</p>","tags":["Palo Alto","Automation"]},{"location":"2025/04/29/palo-alto-panos-api-authentication/#subsequent-api-query-authentication-behaviour","title":"Subsequent API Query Authentication Behaviour","text":"<p>When using an API key across multiple API queries, its important to note that the username and password thats encrypted and encoded within the API key is authenticated for each request. Deleting an admin account or changing its password will render the API key ineffective.</p> <p>Note</p> <p>If admins are remotely authenticated (e.g. using RADIUS) and use a pin+token based password, such as with RSA, any API query after obtaining the API key will fail due to the single-user nature of this type of authentication method. To make subsequent API calls with this type of authentication method refer to the Persistent API Sessions section below.</p> <p>To observe the behaviour, the first step is to generate the API key:</p> <pre><code>curl -k -H \"Content-Type: application/x-www-form-urlencoded\" \\\n-X POST 'https://192.168.12.50/api/?type=keygen' \\\n-d 'user=apiuser' \\\n--data-urlencode 'password=JNn0Sg444s7D0jy5&amp;'\n&lt;response status = 'success'&gt;&lt;result&gt;&lt;key&gt;LUFRPT1IanVrY0k4aUFtUURsaks0MmZ5T2VxNytUckE9R25NSVgyYysyVEw4VmZRakdTazc2bnZNZnplcTdxVmpabGNTRnY3cENLNUl5ZXB4ZDhUVkNJR0Y4VTdXS2pRdFhtU2tPMnp5MEdKejgzTGJsbnpsRmc9PQ==&lt;/key&gt;&lt;/result&gt;&lt;/response&gt;\n</code></pre> <p>Confirm that you're able to query the API using the key:</p> <pre><code>curl -k -H \"X-PAN-KEY: LUFRPT1IanVrY0k4aUFtUURsaks0MmZ5T2VxNytUckE9R25NSVgyYysyVEw4VmZRakdTazc2bnZNZnplcTdxVmpabGNTRnY3cENLNUl5ZXB4ZDhUVkNJR0Y4VTdXS2pRdFhtU2tPMnp5MEdKejgzTGJsbnpsRmc9PQ==\" \\\n-G 'https://192.168.12.50/api/' \\\n-d type=op \\\n-d cmd='&lt;show&gt;&lt;system&gt;&lt;info&gt;&lt;/info&gt;&lt;/system&gt;&lt;/show&gt;'\n&lt;response status=\"success\"&gt;&lt;result&gt;...Removed for brevity...&lt;/result&gt;&lt;/response&gt;\n</code></pre> <p>Then change the password associated with the apiuser account (there isn't a method to disable an account). Query the API again and you'll see that an HTTP 403 error is returned:</p> <pre><code>curl -k -H \"X-PAN-KEY: LUFRPT1IanVrY0k4aUFtUURsaks0MmZ5T2VxNytUckE9R25NSVgyYysyVEw4VmZRakdTazc2bnZNZnplcTdxVmpabGNTRnY3cENLNUl5ZXB4ZDhUVkNJR0Y4VTdXS2pRdFhtU2tPMnp5MEdKejgzTGJsbnpsRmc9PQ==\" \\\n-G 'https://192.168.12.50/api/' \\\n-d type=op \\\n-d cmd='&lt;show&gt;&lt;system&gt;&lt;info&gt;&lt;/info&gt;&lt;/system&gt;&lt;/show&gt;'\n&lt;response status = 'error' code = '403'&gt;&lt;result&gt;&lt;msg&gt;Invalid Credential&lt;/msg&gt;&lt;/result&gt;&lt;/response&gt;\n</code></pre> <p>Finally, set the password associated with the apiuser account back to the original password that you used to obtain the API key. Query the API again and you'll see that a successful response is returned:</p> <pre><code>curl -k -H \"X-PAN-KEY: LUFRPT1IanVrY0k4aUFtUURsaks0MmZ5T2VxNytUckE9R25NSVgyYysyVEw4VmZRakdTazc2bnZNZnplcTdxVmpabGNTRnY3cENLNUl5ZXB4ZDhUVkNJR0Y4VTdXS2pRdFhtU2tPMnp5MEdKejgzTGJsbnpsRmc9PQ==\" \\\n-G 'https://192.168.12.50/api/' \\\n-d type=op \\\n-d cmd='&lt;show&gt;&lt;system&gt;&lt;info&gt;&lt;/info&gt;&lt;/system&gt;&lt;/show&gt;'\n&lt;response status=\"success\"&gt;&lt;result&gt;...Removed for brevity...&lt;/result&gt;&lt;/response&gt;\n</code></pre>","tags":["Palo Alto","Automation"]},{"location":"2025/04/29/palo-alto-panos-api-authentication/#persistent-api-sessions","title":"Persistent API Sessions","text":"<p>As mentioned in the above section, if using a remote authentication method that leverages single-use passwords (e.g. pin+token), subsequent API calls will fail in the Python and cURL methods shown so far in this post. However, you can create a Python Requests session object to maintain a persistent HTTP session which allows you to send multiple API queries.</p> Python <pre><code>import xml.etree.ElementTree as ET\nimport requests\n\nusername = 'apiuser'\npassword = 'JNn0Sg444s7D0jy5&amp;'\nBASE_URL = 'https://192.168.12.50/api/'\nparams = {\n    'type': 'keygen',\n}\nheaders = {\n    'Content-Type': 'application/x-www-form-urlencoded',\n}\ndata = {\n    'user': username,\n    'password': password,\n}\n\ns = requests.Session()\nresp = s.post(\n    BASE_URL,\n    params=params,\n    headers=headers,\n    data=data,\n    verify=False,\n    timeout=5,\n)\nresp.raise_for_status()\n\nroot = ET.fromstring(resp.text)\nkey = root.find('result/key').text\n\nparams = {\n    'type': 'op',\n    'cmd': '&lt;show&gt;&lt;system&gt;&lt;info&gt;&lt;/info&gt;&lt;/system&gt;&lt;/show&gt;'\n}\nheaders = {\n    'X-PAN-KEY': key,\n}\nresp = s.get(\n    BASE_URL,\n    params=params,\n    headers=headers,\n    verify=False,\n    timeout=5,\n)\nresp.raise_for_status()\ns.close()\n\nroot = ET.fromstring(resp.text)\noutput = root.find('result/system')\n</code></pre>","tags":["Palo Alto","Automation"]},{"location":"archive/2025/","title":"2025","text":""},{"location":"category/programmability/","title":"Programmability","text":""}]}